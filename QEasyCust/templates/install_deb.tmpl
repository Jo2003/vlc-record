INSTALL=install
TARGETNW=/usr
PROGFOLDER=[%INT_NAME%]
PROGNEW=[%INT_NAME%]

CHKINST=checkinstall

PKGNAMENW=--pkgname [%INT_NAME%]
REQUIRES=--requires "libqtcore4, libqtgui4, libqt4-network, libqt4-sql-sqlite, vlc, libvlc5, libqt4-xml, libqt4-help, gtk2-engines-pixbuf"
REQUIRESCLC=--requires "libqtcore4, libqtgui4, libqt4-network, libqt4-sql-sqlite, vlc, libqt4-xml, libqt4-help, gtk2-engines-pixbuf"
MAINT=--maintainer "Jo2003 \(coujo@gmx.net\)"
PKGVERNW=--pkgversion [%VERSION%]
PKGGRP=--pkggroup video
PKGSRC=--pkgsource "[%COMP_URL%]"

all: debnew

descr:
	echo "A tool to watch / record IPTV streams from [%COMP_NAME%]" > description-pak

instnew: install_libvlc

rename:
	mv ${PROGSRC} release/${PROGNEW}

install_base:
	${INSTALL} -m 755 -d ${TARGET}/share/${PROGFOLDER}/
	${INSTALL} -m 755 -d ${TARGET}/share/${PROGFOLDER}/language/
	${INSTALL} -m 755 -d ${TARGET}/share/${PROGFOLDER}/modules/
	${INSTALL} -m 755 -d ${TARGET}/share/${PROGFOLDER}/doc/
	${INSTALL} -m 755 -d ${TARGET}/share/${PROGFOLDER}/resources/
	${INSTALL} -s -t ${TARGET}/bin release/${PROG}
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/language language/lang_*.qm
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/doc qhc/*.qch
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/doc qhc/*.qhc
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/modules modules/1_vlc-player.mod
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/modules modules/2_MPlayer.mod
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/modules modules/3_vlc-mp4.mod
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/modules modules/4_vlc-player-avi.mod
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/modules modules/7_vlc-mpeg2.mod
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/modules modules/10_vlc-player_odl.mod
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER} resources/[%INT_NAME%].png
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/resources resources/[%INT_NAME%].qcr
	${INSTALL} -m 644 -t ${TARGET}/share/applications [%INT_NAME%].desktop

install_libvlc: install_base
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/modules modules/5_libvlc.mod
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/modules modules/6_libvlc-mpeg2.mod
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/modules modules/8_libvlc_xvid_avi.mod
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/modules modules/9_libvlc_odl.mod
	${INSTALL} -m 644 -t ${TARGET}/share/${PROGFOLDER}/modules modules/11_libvlc-mp4.mod

debnew: rename descr
	${CHKINST} -y ${PKGNAMENW} ${PKGGRP} ${PKGVERNW} ${MAINT} ${REQUIRES} ${PKGSRC} ${MAKE} TARGET=${TARGETNW} PROG=${PROGNEW} -f install.mak instnew
